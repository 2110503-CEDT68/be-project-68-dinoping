@startuml Put_Update_Reservation

title Update Reservation API Flow (PUT)

actor User
participant "API Server" as API
database MongoDB

User -> API: PUT /api/v1/reservations/{id}\nBody: {reservationDate: Date}\nHeader: Authorization: token
activate API

API -> API: Verify JWT token
API -> MongoDB: Find reservation by ID
activate MongoDB
MongoDB --> API: Return reservation object
deactivate MongoDB

alt Reservation not found
  API --> User: 404 - Reservation not found
else Reservation found
  API -> API: Check authorization\n(user owns reservation or is admin)
  
  alt Not authorized
    API --> User: 401 - Not authorized to update
  else Authorized
    API -> MongoDB: Update reservation
    activate MongoDB
    note right: Update fields:\n- reservationDate\n- other provided fields
    MongoDB --> API: Return updated reservation
    deactivate MongoDB
    
    API -> API: Run validators
    
    alt Validation failed
      API --> User: 400 - Validation error
    else Validation passed
      API --> User: 200 - Success\n{success: true,\ndata: updatedReservation}
    end
  end
end

deactivate API
